#!/bin/bash
# Claude Hooks Statistics Wrapper
# Uses uv to run hooks with proper dependencies

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

show_help() {
    echo "Claude Hooks Statistics"
    echo ""
    echo "Usage: $0 [OPTION]"
    echo ""
    echo "Options:"
    echo "  ssh        Show SSH router learning statistics"
    echo "  bash       Show bash optimizer learning statistics"
    echo "  all        Show all statistics"
    echo "  --help     Show this help"
    echo ""
    echo "Examples:"
    echo "  $0 ssh     # Show SSH learning data"
    echo "  $0 bash    # Show bash optimization data"
    echo "  $0 all     # Show everything"
}

run_with_uv() {
    local script="$1"
    cd "$SCRIPT_DIR"
    
    if command -v uv >/dev/null 2>&1; then
        uv run python3 "$script" --stats
    else
        echo "‚ö†Ô∏è  uv not found. Run update script first:"
        echo "   ~/.claude/claude-hooks/update-claude.sh"
        exit 1
    fi
}

case "${1:-all}" in
    ssh)
        echo "üåê SSH Router Statistics"
        echo "========================"
        run_with_uv "hooks/ssh-router-enhanced.py"
        ;;
    bash)
        echo "‚ö° Bash Optimizer Statistics"
        echo "============================"
        run_with_uv "hooks/bash-optimizer-enhanced.py"
        ;;
    all)
        echo "üåê SSH Router Statistics"
        echo "========================"
        run_with_uv "hooks/ssh-router-enhanced.py"
        echo ""
        echo "‚ö° Bash Optimizer Statistics"
        echo "============================"
        run_with_uv "hooks/bash-optimizer-enhanced.py"
        ;;
    --help|-h|help)
        show_help
        ;;
    *)
        echo "‚ùå Unknown option: $1"
        show_help
        exit 1
        ;;
esac